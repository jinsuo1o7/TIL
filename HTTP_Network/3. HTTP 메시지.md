### HTTP 메시지

HTTP 메시지는 Request메시지와 Response메시지로 나뉘며 메시지 헤더와 메시지 바디로 구성되어 있음

메시지 헤더와 바디는 개행 ( CR + LF )로 나뉨

### 인코딩

HTTP로 데이터를 전송할 때 인코딩을 하여 전송 효율을 높임 ( 컴퓨터 CPU 리소스를 더 소모 )

- 메시지 바디 : HTTP 통신의 **기본 단위** 8비트로 구성됨 통신을 통해서 전송
- 엔티티 : 리퀘스트 리스폰스의 페이로드로 전송되는 정보로 엔티티 헤더와 엔티티 바디로 구성

**HTTP 메시지 바디**는 리퀘스트 리스폰스에 대한 **엔티티 바디를 운반하는 일**

→ 기본으로 메시지 바디와 엔티티 바디는 같지만 전송 코딩때 엔티티 바디의 내용이 변화되어 달라짐

**압축하여 보내는 콘텐츠 코딩**

엔티티에 적용하는 인코딩 중 하나로 정보를 유지한 채로 압축

코딩된 정보는 클라이언트에서 디코딩하여 복원

**분해해서 보내는 청크 코딩**

HTTP 통신에서 Request한 리소스에서 엔티티 바디의 전송이 완료되지 않으면 브라우저에 표시되지 않음

→ **청크 전송 코딩**으로 사이즈가 큰 리소스를 분해해서 조금씩 브라우저에 표시할 수 있음

청크 전송 코딩은 엔티티 바디를 청크(덩어리)로 분해하고 청크 사이즈를 16진수로 사용하여 단락을 표시하고 엔티티 바디 끝에 CR + LF를 기록

### 여러개의 데이터를 보내는 멀티파트

메일의 경우 메일의 본문과 여러개의 첨부파일을 붙여서 함께 보낼 수 있다.

이는 MIME( Mutipurpos Internet Mail Extensions ) 를 사용하여 이미지, 영상, 텍스트 등을 보내는 기능을 사용하기 때문이다.

**멀티파트 :** MIME에서 이미지와 같은 바이너리 데이터를 ASCII 문자열에 인코딩하고 데이터 종류를 나타내는 방법을 규정하고 있음

이처럼 HTTP도 멀티파트 방법과 같이 하나의 메시지 바디에 엔티티를 여러개 포함하여 보내는게 가능

( 이미지나 파일 업로드할때 사용 )

- multipart/form-data : web-form으로부터 파일 업로드 때 사용
- multipart/byteranges : 상태코드 206 리스폰스 메시지가 복수 범위의 내용을 포함 할 때 사용

    ```tsx
    Content-Type: multipart/form-data: **boundary=AaB03x**
    
    --AaB03x
    Content-Disposition: form-data; name="field1"
    
    Jinsuo
    --AaB03x
    Content-Disposition: form-data; name="pics"; filename="file1.txt"
    Content-Type: text/plain
    (file1.txt 데이터...)
    --AaB03x--
    ```

    **boundary=AaB03x : 멀티파트에서 각각의 엔티티를 구분하는 바운더리**

    —**AaB03x : 각각의 엔티티 선두에 바운더리로 구분**

    --**AaB03x-- : 멀티파트의 마무리**

### 일부분만 받는 레인지 리퀘스트

대용량의 데이터를 받을때 커넥션이 끊기면 처음부터 다시 다운받아야 했음

→ resume 기능을 사용해서 이전에 다운받은 지점에서 다시 다운을 재개

레인지 리퀘스트 : 엔티티 범위를 지정하여 리퀘스트

```tsx
GET /tip.jpg HTTP/ 1.1
Host: www.design.jp
**Range: bytes = 5001-10000**
```

```tsx
HTTP/ 1.1 206 Partial Content
Date : ...
Content-Range: bytes 5001-10000/ 10000
Content-Length: 5000
Content-Type: image/jpg**
```

- 206 Partial Content : 레인지 리퀘스트에 대한 응답

    복수 범위의 레인지 리퀘스트는 multipart/byteranges로 응답함

- Range: bytes = 5001-10000 ( 5001-10000 바이트 )
Range: bytes = 5001-10000 ( 5001- 바이트 이상 )
Range: bytes = -3000 5001-10000 ( 처음엔 3000 바이트까지, 5001- 10000바이트 )

### 콘텐츠 네고이에시션 ( Content - Negotianion )

웹 페이지의 내용이 같지만 서로 다른 언어를 사용할때 브라우저가 같은 URI에 액세스할때 각각 영어판과 한국어 판의 웹 페이지를 표시해 줌

- 서버 구동형 네고이에이션
서버측에서 콘텐츠 네고이에이션을 함, 리퀘스트 헤더 필드의 정보를 참고해서 자동으로 처리
- 에이전트 구동형 네고이에이션
클라이언트에서 네고이에이션을 함, 브라우저에 표시된 선택지에서 사용 언어를 수동으로 선택
- 트랜스 페어런트 네고이에이션
서버와 클라이언트 각각 네고이에이션을 하는 혼합 방식
